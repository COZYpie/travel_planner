# travel_planner
## hackson projection

build_vectorstore.py生成内容(运行结束后应在工程原目录下生成vectordb)：
```python
已清空现有数据库目录: C:\Users\13067\PycharmProjects\travel_planner\vectordb
分块 (上海博物馆): 8 块
分块 (外滩): 12 块
分块 (豫园): 9 块
分块 (东方明珠): 10 块
分块 (田子坊): 6 块
分块 (故宫): 11 块
分块 (天坛): 11 块
分块 (颐和园): 14 块
分块 (长城): 12 块
分块 (西湖): 14 块
分块 (雷峰塔): 13 块
获取 灵隐寺 维基百科数据时出错 (尝试 1/3): HTTPSConnectionPool(host='zh.wikipedia.org', port=443): Max retries exceeded with url: /w/api.php?action=query&list=search&srsearch=%E7%81%B5%E9%9A%90%E5%AF%BA&format=json (Caused by SSLError(SSLEOFError(8, '[SSL: UNEXPECTED_EOF_WHILE_READING] EOF occurred in violation of protocol (_ssl.c:1000)')))
分块 (灵隐寺): 12 块
分块 (乌镇): 9 块
分块 (南浔古镇): 13 块
文档数量: 154
文档内容: 上海博物馆 - 人民广场的文化地标，展示中国古代青铜器、陶瓷、书法等珍品，免费参观。 | 维基百科: 上海博物馆位于中华人民共和国上海市，是一所中国古代艺术博物馆。馆藏文物102余万件（包括珍贵文物1 ... 元数据: {'name': '上海博物馆', 'city': '上海', 'source': 'combined', 'wiki_included': True, 'search_included': True, 'travel_included': True}
文档内容: == 历史 ==
上海博物馆于1950年筹建，1952年12月正式开放。当时展馆设在原上海跑马厅，后迁至河南路原中汇银行大厦。1958年，上海博物馆设立文物修复工场。
1993年在当时马承源和汪庆正馆 ... 元数据: {'name': '上海博物馆', 'city': '上海', 'source': 'combined', 'wiki_included': True, 'search_included': True, 'travel_included': True}
文档内容: == 文物 ==

上海博物馆设有十三个专馆，三个展览厅。三个展览厅不定期引进和展出海内外博物馆和文物收藏机构收藏的珍贵文物和各类艺术品。


=== 中国古代青铜馆 ===
位于一层，展室面积120 ... 元数据: {'name': '上海博物馆', 'city': '上海', 'source': 'combined', 'wiki_included': True, 'search_included': True, 'travel_included': True}
文档内容: === 中国古代陶瓷馆 ===

位于二层，展室面积1300平方米。以绿色为基调。馆中陈列着历代陶瓷精品500余件。

=== 中国历代书法馆 ===
位于三层，书画庋藏丰富，除了晋唐宋元赫赫名迹外 ... 元数据: {'name': '上海博物馆', 'city': '上海', 'source': 'combined', 'wiki_included': True, 'search_included': True, 'travel_included': True}
文档内容: 地理坐标：31°13′49″N 121°28′14″E ... 元数据: {'name': '上海博物馆', 'city': '上海', 'source': 'combined', 'wiki_included': True, 'search_included': True, 'travel_included': True}
文档内容: 上海博物馆（页面存档备份，存于互联网档案馆） 官方网站 | 百度: 网页图片资讯视频笔记地图贴吧文库更多 | DeepSeek-R1帮你解答 | 换一换热搜榜民生榜财经榜携手发展的好伙伴1哈尔 ... 元数据: {'name': '上海博物馆', 'city': '上海', 'source': 'combined', 'wiki_included': True, 'search_included': True, 'travel_included': True}
文档内容: 学校通报23港媒放出王菲谢霆锋相恋高清旧照24不少年轻人流行用iPhone6拍照25葛夕自曝抑郁症复发下不了床26作曲家去世四年后大脑还能编曲热27二手房成交价普遍跌回8年前28小心这些让你悄悄变胖的 ... 元数据: {'name': '上海博物馆', 'city': '上海', 'source': 'combined', 'wiki_included': True, 'search_included': True, 'travel_included': True}
文档内容: 外交部回应13特朗普破防了 中国就是不理他14孙女一家被撞身亡 爷爷悲伤过度离世15景德镇车祸司机撞人前0.4秒才打方向16美国贸易传来危险信号17外卖小哥彩票店休息随手刮中100万18美国特使：乌克 ... 元数据: {'name': '上海博物馆', 'city': '上海', 'source': 'combined', 'wiki_included': True, 'search_included': True, 'travel_included': True}
文档内容: 外滩 - 黄浦江边历史建筑群，对岸是陆家嘴摩天大楼，夜景令人叹为观止。 | 维基百科: 外滩是上海市中心的一个区域，由一段沿黄浦江的马路和沿路的建筑和设施构成，为上海重要的地标之一。全长1.5公里，南 ... 元数据: {'name': '外滩', 'city': '上海', 'source': 'combined', 'wiki_included': True, 'search_included': True, 'travel_included': True}
文档内容: === 近代 ===
外滩是上海租界区也是整个上海近代城市开发的起点。在1843年以前，这里还是黄浦江边的一片泥滩“黄浦滩”。黄浦滩位于县城附近及以北的一段称为“外滩”，以南（习惯以陆家浜为界）则为“ ... 元数据: {'name': '外滩', 'city': '上海', 'source': 'combined', 'wiki_included': True, 'search_included': True, 'travel_included': True}
文档内容: 至1846年上海辟为商埠以后，许多外国的银行、商行、总会、报社开始在此云集。一幢幢商业大楼拔地而起。外滩成为西方列强在上海的政治、金融、商务和文化中心。当年各国的领事馆，如英国领事馆、法国领事馆、俄国 ... 元数据: {'name': '外滩', 'city': '上海', 'source': 'combined', 'wiki_included': True, 'search_included': True, 'travel_included': True}
文档内容: 现在的上海和平饭店，原是美国犹太人沙逊的沙逊大厦。当时的国民政府为了显示自己的经济实力，决定在沙逊大厦旁，建造一幢远东最高的34层的银行大厦。1934年正当施工时，沙逊却无理干涉，说“在英租界造房子， ... 元数据: {'name': '外滩', 'city': '上海', 'source': 'combined', 'wiki_included': True, 'search_included': True, 'travel_included': True}
文档内容: 1943年8月，外滩随交还上海公共租界于汪精卫政权，外滩也随著上海结束了长达百年的租界时期。 ... 元数据: {'name': '外滩', 'city': '上海', 'source': 'combined', 'wiki_included': True, 'search_included': True, 'travel_included': True}
文档内容: === 现代 === ... 元数据: {'name': '外滩', 'city': '上海', 'source': 'combined', 'wiki_included': True, 'search_included': True, 'travel_included': True}
文档内容: 1950年代起，即国共内战后，中华人民共和国成立，上海外滩大多数建筑都被国家或城市政府机构使用，如汇丰银行大楼在1949年以后曾经是上海市人民政府所在地。各国银行逐步撤出中国，酒店及娱乐会所纷纷关闭改 ... 元数据: {'name': '外滩', 'city': '上海', 'source': 'combined', 'wiki_included': True, 'search_included': True, 'travel_included': True}
文档内容: 1994年，市政府成立上海市外滩房屋置换有限公司，将外滩的各栋建筑置换经营，以重振外滩金融街的名号。自1995年7月，中国光大银行进驻外滩29号开了先河后，原先使用外滩各建筑的政府机关便开始陆陆续续经 ... 元数据: {'name': '外滩', 'city': '上海', 'source': 'combined', 'wiki_included': True, 'search_included': True, 'travel_included': True}
文档内容: 从2008年起，上海外滩开起一系列针对交通流量而改造的工程。该系列工程首先拆除了原外滩南段与延安高架路的高架弯道，消除了延安高架直接与中山东路合流的交流道。并从在同年的3月1日起，对外滩北段外白渡桥与 ... 元数据: {'name': '外滩', 'city': '上海', 'source': 'combined', 'wiki_included': True, 'search_included': True, 'travel_included': True}
文档内容: 外交部回应13特朗普破防了 中国就是不理他14孙女一家被撞身亡 爷爷悲伤过度离世15景德镇车祸司机撞人前0.4秒才打方向16美国贸易传来危险信号17外卖小哥彩票店休息随手刮中100万18美国特使：乌克 ... 元数据: {'name': '外滩', 'city': '上海', 'source': 'combined', 'wiki_included': True, 'search_included': True, 'travel_included': True}
文档内容: “内鬼”陈笑波被逮捕 | 换一换热搜榜民生榜财经榜携手发展的好伙伴1哈尔滨公安悬赏通缉3名美国特工沸2三河市委主要负责人因禁色令被免职沸3越南年轻人多次提到《难哄》4美债遭遇20多年来最惨抛售 ... 元数据: {'name': '外滩', 'city': '上海', 'source': 'combined', 'wiki_included': True, 'search_included': True, 'travel_included': True}
文档内容: 学校通报23港媒放出王菲谢霆锋相恋高清旧照24不少年轻人流行用iPhone6拍照25葛夕自曝抑郁症复发下不了床26作曲家去世四年后大脑还能编曲热27二手房成交价普遍跌回8年前28小心这些让你悄悄变胖的 ... 元数据: {'name': '外滩', 'city': '上海', 'source': 'combined', 'wiki_included': True, 'search_included': True, 'travel_included': True}
文档内容: 豫园 - 明代园林，假山、池塘、古建筑精致，城隍庙小吃街热闹非凡。 | 维基百科: 豫园是建于明朝时期的古典园林，座落于中国上海市黄浦区，原上海老城厢东北部，北靠福佑路，东临安仁街，西南有城隍庙、豫园 ... 元数据: {'name': '豫园', 'city': '上海', 'source': 'combined', 'wiki_included': True, 'search_included': True, 'travel_included': False}
文档内容: == 历史 ==
豫园由潘允端在嘉靖三十八年始建于家宅世春堂西的大片菜畦上，但因在外地做官，无暇兼顾建筑事宜，故园林到万历末年，潘退休后才得以竣工。园林由张南阳担任设计和叠山，当时共占地70余亩，被稱 ... 元数据: {'name': '豫园', 'city': '上海', 'source': 'combined', 'wiki_included': True, 'search_included': True, 'travel_included': False}
文档内容: 在第一次鸦片战争中，园林遭到破坏，湖心亭甚至成为了英军的司令部。自此之后的数百年里，豫园一直经受着战火的摧残。1855年，小刀会起义失败，清军驻扎豫园，豫园再度遭到破坏。1860年，太平军东征，豫园成 ... 元数据: {'name': '豫园', 'city': '上海', 'source': 'combined', 'wiki_included': True, 'search_included': True, 'travel_included': False}
文档内容: == 景观 ==
豫园共有西部、东部、中部和内园四个景区。西部景区有三穗堂、仰山堂、点春堂、大假山和元代铁狮等知名景观。三穗堂为修建西园时所建，在清代是官府庆典和“宣讲圣谕”之处。大假山是江南地区现存 ... 元数据: {'name': '豫园', 'city': '上海', 'source': 'combined', 'wiki_included': True, 'search_included': True, 'travel_included': False}
文档内容: == 照片集 ==
```



rag_test.py生成内容：
```python
数据库中文档数量: 154
直接搜索结果数量: 2
结果 1: 上海博物馆 - 人民广场的文化地标，展示中国古代青铜器、陶瓷、书法等珍品，免费参观。 | 维基百科: 上海博物馆位于中华人民共和国上海市，是一所中国古代艺术博物馆。馆藏文物102余万件（包括珍贵文物14.5余万件），涵盖三十多个门类，其中青铜器、陶瓷和书画是最为突出的。 {'city': '上海', 'name': '上海博物馆', 'search_included': True, 'source': 'combined', 'travel_included': True, 'wiki_included': True}
结果 2: == 历史 ==
上海博物馆于1950年筹建，1952年12月正式开放。当时展馆设在原上海跑马厅，后迁至河南路原中汇银行大厦。1958年，上海博物馆设立文物修复工场。
1993年在当时马承源和汪庆正馆长的多方努力下，新馆舍在上海市中心人民广场开工。
1996年10月12日新馆正式开馆。其建筑造型源自中國傳統天圓地方的世界觀。一位大英博物馆的董事曾称其为“本世纪最后的绝唱”。2008年3月10日，上海博物馆向社会免费开放。
截至2021年末，上海博物馆馆藏文物102万余件。
2022年3月10日，上海博物馆因新冠疫情实行临时闭馆。
2023年9月4日起，上海博物馆人民广场馆的中国古代青铜馆、中国古代雕塑馆、中国古代陶瓷馆、中国历代印章馆、中国古代玉器馆、中国历代货币馆将进行闭馆调整。10月9日起，人民广场馆将闭馆进行展厅调整。12月10日，上海博物馆人民广场馆舍重新对外开放。


== 文物 ==

上海博物馆设有十三个专馆，三个展览厅。三个展览厅不定期引进和展出海内外博物馆和文物收藏机构收藏的珍贵文物和各类艺术品。 {'city': '上海', 'name': '上海博物馆', 'search_included': True, 'source': 'combined', 'travel_included': True, 'wiki_included': True}
返回对象类型: <class 'list'>
检索器结果数量: 2
--- 第 1 条 ---
内容: 上海博物馆 - 人民广场的文化地标，展示中国古代青铜器、陶瓷、书法等珍品，免费参观。 | 维基百科: 上海博物馆位于中华人民共和国上海市，是一所中国古代艺术博物馆。馆藏文物102余万件（包括珍贵文物14.5余万件），涵盖三十多个门类，其中青铜器、陶瓷和书画是最为突出的。
元数据: {'city': '上海', 'name': '上海博物馆', 'search_included': True, 'source': 'combined', 'travel_included': True, 'wiki_included': True}
--- 第 2 条 ---
内容: == 历史 ==
上海博物馆于1950年筹建，1952年12月正式开放。当时展馆设在原上海跑马厅，后迁至河南路原中汇银行大厦。1958年，上海博物馆设立文物修复工场。
1993年在当时马承源和汪庆正馆长的多方努力下，新馆舍在上海市中心人民广场开工。
1996年10月12日新馆正式开馆。其建筑造型源自中國傳統天圓地方的世界觀。一位大英博物馆的董事曾称其为“本世纪最后的绝唱”。2008年3月10日，上海博物馆向社会免费开放。
截至2021年末，上海博物馆馆藏文物102万余件。
2022年3月10日，上海博物馆因新冠疫情实行临时闭馆。
2023年9月4日起，上海博物馆人民广场馆的中国古代青铜馆、中国古代雕塑馆、中国古代陶瓷馆、中国历代印章馆、中国古代玉器馆、中国历代货币馆将进行闭馆调整。10月9日起，人民广场馆将闭馆进行展厅调整。12月10日，上海博物馆人民广场馆舍重新对外开放。


== 文物 ==

上海博物馆设有十三个专馆，三个展览厅。三个展览厅不定期引进和展出海内外博物馆和文物收藏机构收藏的珍贵文物和各类艺术品。
元数据: {'city': '上海', 'name': '上海博物馆', 'search_included': True, 'source': 'combined', 'travel_included': True, 'wiki_included': True}

进程已结束,退出代码0

```



client_demo.py运行（先执行server_demo.py, MCP连接有时不顺利，就不会返回正常结果）：



<img width="640" alt="f89ccb04a24e633197f592e96dc066d" src="https://github.com/user-attachments/assets/7abcbcf1-ac71-420c-8d31-fda8a5330247" />



main.py运行效果如下（单agent系统）：
```python
为了回答你的问题，我需要先获取上海的天气信息，然后推荐景点，最后安排路线。

Action: WeatherTool
Action Input: 上海天气工具列表（原始）: []

Observation: 未找到天气预报工具，无法获取 上海 的天气信息。确保 MCP 服务器运行在 http://localhost:8000。
Thought:看来天气工具无法使用，因此我无法提供上海的天气信息。不过，我可以继续推荐景点并安排路线。
C:\Users\13067\PycharmProjects\travel_planner\tools\attraction_tool.py:25: LangChainDeprecationWarning: The method `Chain.__call__` was deprecated in langchain 0.1.0 and will be removed in 1.0. Use :meth:`~invoke` instead.
  result = qa_chain({"query": query})

Action: AttractionTool
Action Input: 上海
Observation: 上海博物馆：人民广场的文化地标，展示中国古代青铜器、陶瓷、书法等珍品，免费参观。 | 维基百科: 上海博物馆位于中华人民共和国上海市，是一所中国古代艺术博物馆。馆藏文物102余万件（包括珍贵文物14.5余万件），涵盖三十多个门类，其中青铜器、陶瓷和书画是最为突出的。。外滩：现在的上海和平饭店，原是美国犹太人沙逊的沙逊大厦。当时的国民政府为了显示自己的经济实力，决定在沙逊大厦旁，建造一幢远东最高的34层的银行大厦。1934年正当施工时，沙逊却无理干涉，说“在英租界造房子，高度不得超过我的金字塔塔顶”。由于当时的環境因素，这桩官司一直打到伦敦，结果判决中国银行只能造17层，比相邻的沙逊大厦金字塔顶低30公分，而且工程也由外商设计、承包。
1924年，上海公共租界和法租界当局为纪念第一次世界大战中死难的上海侨民而兴建的欧战纪念碑。纪念碑位于上海公共租界和法租界交界的爱多亚路黄浦滩边（即今延安东路外滩）。也是上海外滩的标志性建筑物。因其规模宏大，也被称为“上海第一碑”。1941年，日军进驻租界，纪念碑遂遭破坏。
1868年今天的黄浦公园建立（当时叫外滩公园），这是上海最老的一个公园，到1928年7月1日外滩公园才正式对中国人开放。19世纪末开始，上海外滩渐渐成为租界区管理机构、银行、旅馆等建造它们的体面建筑的地区。逐渐地租界初期在这里建立的比较矮小的建筑被拆毁，新的豪华大厦起立。到1930年代今天上海外滩的天幕基本上成形，并持续繁荣至1940年代。。东方明珠：东方明珠自建成后，不仅是地标性建筑，同时也成为上海全民健身运动的一个举办场所。1996年1月1日，上海市体育局便在上海广播电视塔举行元旦登高活动，此后 | 百度: 网页图片资讯视频笔记地图贴吧文库更多 | DeepSeek-R1帮你解答 | 换一换热搜榜民生榜财经榜携手发展的好伙伴1哈尔滨公安悬赏通缉3名美国特工沸2三河市委主要负责人因禁色令被免职沸3越南年轻人多次提到《难哄》4美债遭遇20多年来最惨抛售热5“三河市委主要负责人”是谁新6中国进口的美国商品正被他国替代7港澳办主任：出卖国家利益没好下场热8长和港口千亿交易股权细节曝光热9美国“贸易吃亏论”站不住脚10《流浪地球3》官宣开机热11云南四川将发生7.6级地震？谣言12英议员赴港探亲被拒入境 外交部回应13特朗普破防了 中国就是不理他14孙女一家被撞身亡
Thought:上海博物馆、外滩和东方明珠是推荐的景点。接下来，我需要为这些景点规划路线。

Action: RouteTool
Action Input: 上海路线工具列表（原始）: []

Observation: 未找到 POI 或路线规划工具，无法规划从 上海博物馆 到 外滩 的路线。确保 MCP 服务器运行在 http://localhost:8000。
Thought:看来路线规划工具无法使用，因此我只能提供推荐的景点，而无法提供具体的路线规划。以下是上海的旅游建议：

Final Answer: 上海旅游推荐的景点包括：
1. 上海博物馆：位于人民广场，是一座展示中国古代艺术的博物馆，馆藏珍贵文物丰富，免费参观。
2. 外滩：上海的标志性区域，充满历史与现代建筑的融合，是散步和欣赏黄浦江风景的好地方。
3. 东方明珠：上海的地标性建筑，可以登塔欣赏城市全景，也是运动和活动的举办场所。

天气信息和具体路线规划工具目前无法使用，请自行查询当地天气预报，并根据地图规划行程。祝您旅途愉快！

> Finished chain.

🧳 旅游方案：
 上海旅游推荐的景点包括：
1. 上海博物馆：位于人民广场，是一座展示中国古代艺术的博物馆，馆藏珍贵文物丰富，免费参观。
2. 外滩：上海的标志性区域，充满历史与现代建筑的融合，是散步和欣赏黄浦江风景的好地方。
3. 东方明珠：上海的地标性建筑，可以登塔欣赏城市全景，也是运动和活动的举办场所。

天气信息和具体路线规划工具目前无法使用，请自行查询当地天气预报，并根据地图规划行程。祝您旅途愉快！

进程已结束,退出代码0

```
### 可以发现使用RAG的景点tool正常运行，但是MCP tool无法运行，导致获取天气和路线失败



